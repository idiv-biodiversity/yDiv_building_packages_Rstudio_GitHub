---
title: "Functions and Documentation"
output:
  html_document:
    toc: true
    toc_depth: 2
---

# Introduction


Initial blabla about functions and their documentation


# Create your first function


```{r, eval=FALSE}
use_r(name = "greet")
#> ✔ Setting active project to '/home/se87kuhe/my_science/r-dev/myPackage'
#> ● Modify 'R/greet.R'
```

Insert and save the following code into the file that just opened:

```{r, eval=FALSE}
greet <- function(whom){
  message(paste0("Hello '", whom, "'!"))
}
```

Reload the package

```{r, eval=FALSE}
load_all()
#> Loading myPackage
```

And run the function

```{r, eval=FALSE}
greet(whom = "World")
#> Hello 'World'!
```

## Your turn

However, we want our function to do something more fancy, for instance ...

* plot summary statistics of your data
* draw boxplots, a scatterplot or a timeline
* reproduce the analysis you carried out in your manuscript
* ...

```{r, eval=FALSE}

```

*Make an example with a bit about what required and what optional arguments are*

*This is the point where the students shall write their own stuff...*




# Write a documentation

Now you learn what you need to put together the documentation of your function. This work is largely based on the package `roxygen2`. To signal to this package how the documentation shall look like, you have to write a couple of things by hand and tag them with markup codes. This markup code is a bit like latex, if you know that you will recognise many of the markup codes. For example, to start a list, you'd use the `\itemize{ \item }`-notation, to emphasize a word, you'd write `\emph{a word}` or to make a verbatim code statement, you'd write `\code{greet}`. Check out [this link](https://cran.r-project.org/web/packages/roxygen2/vignettes/formatting.html) for a complete documentation.


Back in the tab that shows your function, insert a roxygen skeleton, via *Code > Insert Roxygen Skeleton*. The file `greet.R` would then look as follows.

```{r}
#' Title
#'
#' @param whom 
#'
#' @return 
#' @export
#'
#' @examples

greet <- function(whom){
  message(paste0("Hello '", whom, "'!"))
}
```

## Arguments

`@param` documents the functions parameters, or *arguments* in R terminology.
There are no real conventions on how an argument shall be defined, however, since the `checkmate` package is around, some authors include information about the nature of the argument. Here, the type of argument, which would be expected by the test/assert-functions of `checkmate`, is explicitly mentioned.

```{r}
#' @param whom [\code{character(1)}]\cr The person/entity that shall be greeted.

```

This documentation would show up as in [this link](https://mllg.github.io/checkmate/reference/checkCharacter.html#arguments). It makes clear that the argument is supposed to be a `character` vector with length 1.

## Function output

`@return` typically documents a very brief description of what is being returned by the function. This does not document how the object has been derived but really merely what the object is.

## Export

`@export` is a switch that is picked up by `roxygen2` to update the namespace, i.e., it signals that this function shall be exported into the R ecosystem (and thus be available publicly to other users).

## Examples

`@examples` showcases how the function works. Those examples are mostly for the humans that are supposed to understand and use your function. However, as we see later, they are also taken to check and validate the package.

## Other fields

`@details` Supply additional information that are required to understand your function. Often this is where it lacks, even in popular packages, so try to get into the habbit of properly explaining also "obvious" things.

`@section Something more` Adds the section `Something more` to your documentation. Everything in this line is the title and the text starts in the next line.

`@format` is typically used to document datasets and gives an overview of the data structure.

`@importFrom checkmate assertCharacter assertNames` informs `roxygen` that the functions `assertCharacter` and `assertNames` shall be imported from the package `checkmate`. We recommend that you document all non-base functions that are imported in your custom function, even if that would mean duplicated `@importFrom` statements for several functions. This ensures that you don't forget to import anything and avoids debugging you would not understand easily at the beginning.

There are some more tags that are not discussed here, see [this link](https://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html) for more.

## Update documentation

Fill in the following information into the documentation of `greet.R`.


```{r}
#' Kindly greet the first user of your package
#'
#' @param whom [\code{character(1)}]\cr The person/entity that shall be greeted.
#'
#' @return Character string that greets.
#' @export
#'
#' @examples
#' # greet the world ...
#' greet(whom = "World")
#'
#' # ... or a range of numbers
#' greet(c(1, 2, 3, 4))

greet <- function(whom){
  message(paste0("Hello '", whom, "'!"))
}
```

And build the documentation

```{r, eval=FALSE}
document()
#> Updating myPackage documentation
#> Updating roxygen version in /home/se87kuhe/my_science/r-dev/myPackage/DESCRIPTION
#> Writing NAMESPACE
#> Loading myPackage
#> Writing NAMESPACE
#> Writing greet.Rd
```

Apparently `NAMESPACE` has been modified, that warrants that we check it out. It should contain now:

```{r, eval=FALSE}
# Generated by roxygen2: do not edit by hand

export(greet)
```

We see that it contains a note and a single command. The note is to be taken seriously! If things in `NAMESPACE` are not as they are supposed to be, everything breaks. So keep your fingers off of that unless you consider yourself professional enough to mess around. The command says that the function `greet` shall be exported, as expected, because we have set the `@export` tag above.


With `?greet` or `help(greet)` you can view the documentation you just wrote and built. In case you don't like anything about it, revise the text and rebuild the documentation via `document()`.

## Your turn

Do the same for your own function.
